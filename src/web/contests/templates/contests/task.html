{% extends '_layout.html' %}

{% load markdown_deux_tags %}
{% load bootstrap %}

{% block title %}{{ statement.title }} &bull; {{ contest.name }}{% endblock %}

{% block content %}
    <div class="page task-page">
        <h1 class="page__header">
            {{ task.max_score }}.
            {{ statement.title }}
        </h1>

        {{ statement.statement|markdown }}

        {% if files %}
            <div class="task__files mt30 mb20">
                {% for file in files %}
                    <div class="task__file ib">
                        <a href="{% url 'contests:task_file' contest.id file.id %}" class="btn btn-primary btn-lg">
                            <span class="glyphicon glyphicon-download"></span>
                            {{ file.name|default:'File' }}
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {% if user.is_authenticated and contest.is_running and participant %}
            <form method="POST" action="" class="attempt-form  mt30  form-inline">
                {% csrf_token %}
                {{ attempt_form|bootstrap_inline }}
                <div class="form-group">
                    <button class="ml15 btn btn-success btn-lg">Send</button>
                </div>
            </form>
        {% elif not contest.is_running %}
            {% if contest.is_finished %}
                <div class="text-danger pt15 fw400">
                    Sorry, you can't send answer after the contest finished.
                </div>
            {% endif %}
        {% elif not user.is_authenticated %}
            <div class="pt15 fw400">
                <a href="{% url 'users:login' %}">Authorize</a> to send an answer.
            </div>
        {% elif not participant %}
            <div class="text-danger pt15 fw400">
                <a href="" class="post-link" data-url="{% url 'contests:join' contest.id %}">Join</a> to the contest to solve tasks.
            </div>
        {% endif %}

    </div>
{% endblock %}